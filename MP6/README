This is the code for MP6.
